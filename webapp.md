---
layout: page
title: Web-приложение
permalink: /webapp/
---

Полезная нагрузка web-приложения основывается на коде standalone-парсера, и добавляет к нему полноценный web-интерфейс.
Я использовал для реализации Django — кажущийся overengineering с лихвой компенсируется моим опытом с этим фреймворком,
а в качестве приятного бонуса мы получаем и удобную админку, и возможности по очень гибкому развитию проекта.

Инструкция по запуску находится в файле `backend/README.md`. Повторим её здесь:

```bash
cd backend
virtualenv -p `which python3` venv
. venv/activate
pip install -r requirements.txt
./manage.py migrate
./manage.py runserver_plus
# откройте в браузере основной интерфейс http://localhost:8000
# и/или админку базы данных через http://localhost:8000/admin/
# (используйте ./manage.py createsuperuser для создания пользователя)
```


## Модели

В файле `parcels/models.py` можно обнаружить две основные модели:

- `CadastralBlock` — кадастровую запись о квартале (или аналогичной территории, кадастровому блоку).
  Практически она соответствует одному загружаемому XML-файлу.
- `Parcel` — собственно участок с информацией о его геометрии (в виде `JSONField`, точнее его совсем
  простецкой SQLite-эмуляции).

Обе модели умеют сохраняться в формате `csv` с учётом кеширования файлов. `CadastralBlock` кроме того
содержит статический метод для парсинга входных файлов.

В файле `parcels/admin.py` содержится декларативная конфигурация админки для этих моделей.


## Парсинг

В файле `parcels/parser.py` содержится немного модифицированный код standalone-парсера. Основное отличие
состоит в том, что он извлекает не только `parcels`, но и метаданные о `cadastral block`.


## Web-интерфейс

В файлах `urls.py` и `views.py` содержится код, организующий логику web-интерфейса; в папках `templates`
и `static` — соответственно html-шаблоны и css-стили этого интерфейса.